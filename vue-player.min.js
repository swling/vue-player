function vue_player(t){let i={container:"",urls:"",volume:.5,autoplay:!0,is_audio:!0,is_live:!0,url_start:0,callback:!1,errorback:!1};t=Object.assign(i,t);let s='\n<div id="vue-player">\n\t<div class="columns is-marginless is-multiline is-mobile is-align-items-center">\n\t\t<div id="media-canvas" class="column is-full mb-5" v-show="!config.is_audio">\n\t\t\t<audio v-if="config.is_audio" id="audio-el" class="is-hidden"></audio>\n\t\t\t<video v-else id="video-el"></video>\n\t\t</div>\n\t\t<div id="seek-slider" class="column is-full mb-3 pt-3" v-show="!config.is_live">\n\t\t\t<input type="range" max="0" value="0">\n\t\t</div>\n\t\t<div id="play-button-wrap" class="column is-1">\n\t\t\t<button @click="toggle()" class=\'play-button\' :class="\'playing\' == status ? \'paused\' : \'\'"></button>\n\t\t</div>\n\t\t<div id="status-bar" class="column is-1">\n\t\t\t<div class="status loading" v-show="status_show(\'loading\')"></div>\n\t\t\t<div class="music-bar" :class="get_status()" v-show="music_show()">\n\t\t\t\t<span class="bar n1"></span>\n\t\t\t\t<span class="bar n2"></span>\n\t\t\t\t<span class="bar n3"></span>\n\t\t\t\t<span class="bar n4"></span>\n\t\t\t</div>\n\t\t\t<span v-show="status_show(\'error\')"><i>Error !</i></span>\n\t\t</div>\n\t\t<div id="info-bar" class="column is-4 is-justify-content-left">\n\t\t\t<a @click="fullscreen()" class="full-screen mr-5" v-show="!config.is_audio"></a>\n            <span v-show="loading_time">……</span>\n            <div v-show="msg && !loading_time" class="is-size-7" v-html="msg"></div>\n\t\t</div>\n\t\t<div id="tools-bar" class="column is-auto is-justify-content-right"> \n            <div id="line-switcher" class="is-size-7" style="text-shadow:none;color:#EEE;">\n                <div style="text-align:left;position: absolute;top:100%;z-index:99;background:#CF8E8A;padding:10px;border-radius:0 0 3px 3px;" :class="show_line ? \'\' : \'is-hidden\' ">\n                    <ul>\n                        <li v-for="(stream, index) in config.urls"><a @click="switch_stream(index)">L{{(index + 1) + \'. \' + stream.type}}</a></li>\n                    </ul>\n                </div>\n                <a @click="line_show()"><span style="user-select:none;padding:3px 10px;border-radius:3px;box-shadow:0px 0px 1px #500;">Line : {{url_index + 1}}</span></a>\n            </div>\n            <input id="volume-bar" class="is-hidden-touch ml-3" type="range" max="1" step="0.001" v-model="volume">\n\t\t</div>\n\t</div>\n</div>',e={template:s,data:()=>({config:t,player:null,volume:t.volume,autoplay:t.autoplay,url:"",url_index:t.url_start,cors:!1,status:"",canplay:!1,monitor:null,current_time:0,duration:0,error_count:0,loading_time:0,loading_interval:null,tryagin_timer:null,show_line:!1,msg:""}),methods:{build:function(){let i=!t.urls.some(t=>t.url.length>0);if(i)return;let s=t.is_audio?"audio-el":"video-el";this.player=document.getElementById(s),this.init_meida(),this.build_player();let e=t.callback;"function"==typeof e&&e(this)},require_hls:function(){return!this.is_app_safari()&&this.url.includes(".m3u8")},require_dash:function(){return this.url.includes(".mpd")},is_app_safari:function(){const t=/Mac|iPhone|iPod|iPad/i,i=/Chrome|Android|CriOS|FxiOS|EdgiOS/i,s=/Safari/i,e=navigator.userAgent;return!i.test(e)&&(t.test(e)&&s.test(e))},build_player:async function(){return this.cors<0?this.is_mobile()?this.build_h5_player():(this.msg="Error on line "+(this.url_index+1),void(this.url_index<t.urls.length-1&&(this.url_index++,this.build()))):this.require_hls()?("undefined"==typeof Hls&&await this.load_script("https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/hls.js/1.1.5/hls.min.js"),this.build_hls_player()):this.require_dash()?("undefined"==typeof dashjs&&await this.load_script("https://cdn.dashjs.org/v4.6.0/dash.all.min.js"),this.build_dash_player()):void this.build_h5_player()},toggle:function(){if("error"==this.status||"loading"==this.status)return this.error_count=0,this.tryagin();"playing"!=this.status?this.player.play():this.player.pause()},get_status:function(){return"loading"==this.status&&this.canplay?"canplay":["init","loading","waiting"].includes(this.status)?"loading":this.status},status_show:function(t){return t==this.get_status()},music_show:function(){return["playing","pause","canplay","ready","play"].includes(this.get_status())},line_show:function(){this.show_line=!this.show_line},fullscreen:function(){this.player.requestFullscreen()},build_h5_player:function(){this.player.src=this.url,this.player.autoplay=this.autoplay,this.player.volume=this.volume,this.monitor_h5(this.player),this.autoplay&&this.player.play()},monitor_h5:function(i){i.ontimeupdate=(()=>{this.error_count>0&&i.currentTime>0&&(this.error_count=0),"playing"!=this.status&&(this.status="playing")}),i.onloadstart=i.onloadeddata=i.onloadedmetadata=i.onwaiting=(()=>{this.status="loading",this.loading_interval||(this.loading_interval=setInterval(()=>{this.loading_time++},1e3))}),i.onended=(()=>{t.is_live?this.handle_error():(this.status="pause",this.stop_loading_monitor())}),i.onpause=i.oncanplay=(()=>{this.status="pause",this.stop_loading_monitor()}),hls&&hls.media||(i.onerror=(()=>{this.handle_error()}))},build_hls_player:function(){hls=new Hls,Hls.isSupported()?(this.player.load(),hls.loadSource(this.url),hls.attachMedia(this.player),this.player.autoplay=this.autoplay,this.player.volume=this.volume,this.monitor_h5(this.player),this.autoplay&&this.player.play(),hls.on(Hls.Events.ERROR,(t,i)=>{if(i.fatal)switch(this.handle_error(),i.type){case Hls.ErrorTypes.NETWORK_ERROR:console.log("fatal network error encountered, try to recover");break;case Hls.ErrorTypes.MEDIA_ERROR:console.log("fatal media error encountered, try to recover"),hls.recoverMediaError();break;default:console.log(i.details),hls.destroy()}})):this.build_h5_player()},build_dash_player:function(){this.player.load();let t=dashjs.MediaPlayer().create();t.initialize(this.player,this.url,this.autoplay),t.setVolume(this.volume),this.monitor_h5(this.player),t.on("error",t=>{this.handle_error()})},handle_error:function(){this.stop_loading_monitor(),this.error_count++,this.status="error";let i=t.errorback;"function"==typeof i&&i(this),this.error_count>=3&&this.url_index>=t.urls.length-1||(this.error_count<3?this.tryagin():this.url_index<t.urls.length-1&&(clearTimeout(this.tryagin_timer),this.error_count=0,this.url_index++,this.build()))},init_meida:function(){let i=t.urls[this.url_index];this.url=i.url,this.cors=i.cors||1,hls&&hls.destroy()},tryagin:function(){this.tryagin_timer=setTimeout(()=>{this.status="loading",hls?hls.loadSource(this.url):this.player.src=this.url,this.player.load(),this.player.play()},1e3*this.error_count)},stop_loading_monitor:function(){clearInterval(this.loading_interval),this.loading_time=0},switch_stream:function(t){this.line_show(),this.url_index=t,this.init_meida,this.build()},load_urls:function(t,i){this.url_index=i,this.config.urls=t,this.build()},is_mobile:function(){return!!navigator.userAgent.match(/(iPhone|iPad|iPod|Android|ios|App\/)/i)},load_script:function(t){return new Promise(function(i,s){let e=document.createElement("script");e.type="text/javascript",e.src=t,document.head.appendChild(e),e.onload=(()=>{i(!0)})})}},mounted:function(){this.build()},watch:{volume:function(t){this.player.volume=t,localStorage.setItem("wndt_volume",t)},loading_time:function(t){t>=30&&(this.loading_time=0,this.tryagin())}}};Vue.createApp(e).mount(t.container)}let hls=null;